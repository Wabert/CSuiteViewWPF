<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:views="clr-namespace:CSuiteViewWPF.Windows">

  <!-- Localized button utilities used by the window chrome -->
  <!-- Minimal button style with no hover/focus visual -->
  <Style x:Key="NoHoverButton" TargetType="Button">
    <Setter Property="Background" Value="Transparent" />
    <Setter Property="BorderThickness" Value="0" />
    <Setter Property="Padding" Value="0" />
    <Setter Property="Focusable" Value="False" />
    <Setter Property="Template">
      <Setter.Value>
        <ControlTemplate TargetType="Button">
          <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
        </ControlTemplate>
      </Setter.Value>
    </Setter>
  </Style>

  <!-- Gold circle close button template - tokenized brushes -->
  <ControlTemplate x:Key="GoldCircleCloseButton.Template" TargetType="Button">
    <Grid Width="25" Height="25">
      <Ellipse Fill="{DynamicResource WindowChrome.CloseButton.FillBrush}"
               Stroke="{DynamicResource WindowChrome.CloseButton.StrokeBrush}"
               StrokeThickness="2"/>
      <Canvas Width="12" Height="12" HorizontalAlignment="Center" VerticalAlignment="Center" SnapsToDevicePixels="True">
        <Line X1="0" Y1="0" X2="12" Y2="12" Stroke="{DynamicResource WindowChrome.CloseButton.CrossBrush}" StrokeThickness="3" StrokeStartLineCap="Round" StrokeEndLineCap="Round" />
        <Line X1="12" Y1="0" X2="0" Y2="12" Stroke="{DynamicResource WindowChrome.CloseButton.CrossBrush}" StrokeThickness="3" StrokeStartLineCap="Round" StrokeEndLineCap="Round" />
      </Canvas>
    </Grid>
  </ControlTemplate>

  <!-- Reusable Close Button Style using a ControlTemplate so visuals are not shared across instances -->
  <Style x:Key="GoldCircleCloseButton" TargetType="Button" BasedOn="{StaticResource NoHoverButton}">
    <Setter Property="Width" Value="25" />
    <Setter Property="Height" Value="25" />
    <Setter Property="IsTabStop" Value="False" />
    <Setter Property="SnapsToDevicePixels" Value="True"/>
    <Setter Property="UseLayoutRounding" Value="True"/>
    <Setter Property="Template" Value="{StaticResource GoldCircleCloseButton.Template}"/>
  </Style>

  <!-- Generic ThemedWindow template (structure only, brushes via tokens) -->
  <ControlTemplate x:Key="ThemedWindow.Template" TargetType="views:ThemedWindow">
    <!-- Outer frame -->
    <Border Background="{DynamicResource WindowChrome.BorderBrush}"
            BorderBrush="{DynamicResource WindowChrome.BorderBrush}"
            BorderThickness="{DynamicResource WindowChrome.BorderThickness}"
            SnapsToDevicePixels="True">
      <Grid SnapsToDevicePixels="True">
        <Grid.RowDefinitions>
          <RowDefinition Height="{DynamicResource WindowChrome.HeaderHeight}"/>
          <RowDefinition Height="Auto"/>
          <RowDefinition Height="*"/>
          <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <Border Grid.Row="0"
                Background="{DynamicResource WindowChrome.HeaderBackgroundBrush}"
                CornerRadius="{DynamicResource WindowChrome.HeaderCornerRadius}"
                ClipToBounds="True">
          <DockPanel x:Name="PART_Header">
            <StackPanel x:Name="PART_WindowButtons"
                        Orientation="Horizontal"
                        DockPanel.Dock="Right"
                        HorizontalAlignment="Right"
                        VerticalAlignment="Center"
                        Margin="0,0,10,10">
              <Button x:Name="CloseBtn"
                      Style="{DynamicResource GoldCircleCloseButton}"
                      Command="{x:Static ApplicationCommands.Close}"/>
            </StackPanel>

            <TextBlock Text="{TemplateBinding Title}"
                       Margin="20,0,0,0"
                       VerticalAlignment="Center"
                       Foreground="{DynamicResource WindowChrome.HeaderForegroundBrush}"
                       FontSize="20"
                       FontWeight="Bold"/>
          </DockPanel>
        </Border>

        <!-- Hairline under header -->
        <Rectangle Grid.Row="1" Height="1" Fill="{DynamicResource WindowChrome.HairlineBrush}"/>

        <!-- Body -->
        <Border Grid.Row="2"
                Background="{DynamicResource WindowChrome.BodyBackgroundBrush}"
                CornerRadius="{DynamicResource WindowChrome.BodyCornerRadius}"
                ClipToBounds="True"
                Padding="{DynamicResource Thickness.Padding.M}">
          <ContentPresenter x:Name="PART_ContentHost"/>
        </Border>

        <!-- Footer placeholder -->
        <Border Grid.Row="3" Height="0" Background="Transparent"/>
      </Grid>
    </Border>

    <ControlTemplate.Triggers>
      <Trigger Property="views:ThemedWindow.ShowHeaderButtons" Value="False">
        <Setter TargetName="PART_WindowButtons" Property="UIElement.Visibility" Value="Collapsed"/>
      </Trigger>
    </ControlTemplate.Triggers>
  </ControlTemplate>

</ResourceDictionary>
