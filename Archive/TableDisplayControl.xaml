<UserControl x:Class="CSuiteViewWPF.TableDisplayControl"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:models="clr-namespace:CSuiteViewWPF.Models"
    Height="Auto" Width="Auto">

    <Border Padding="1" CornerRadius="6" BorderBrush="{StaticResource GoldBrush}" BorderThickness="2" Background="Transparent" MaxWidth="640">
        <Grid>
            <Grid.Resources>
                <!-- Header style using gold gradient similar to RoundedBrassButtonStyle -->
                <Style TargetType="DataGridColumnHeader">
                    <Setter Property="Foreground" Value="{StaticResource DarkBlue}" />
                    <Setter Property="FontWeight" Value="Bold" />
                    <Setter Property="Padding" Value="6,4" />
                    <Setter Property="HorizontalContentAlignment" Value="Center" />
                    <Setter Property="Background">
                        <Setter.Value>
                            <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                <GradientStop Color="#FFF6E0" Offset="0.0" />
                                <GradientStop Color="#FFD24D" Offset="0.5" />
                                <GradientStop Color="#FFB800" Offset="1.0" />
                            </LinearGradientBrush>
                        </Setter.Value>
                    </Setter>
                    <Setter Property="BorderBrush" Value="{StaticResource DarkBlue}" />
                    <!-- show a vertical divider on the right of each header plus bottom line -->
                    <Setter Property="BorderThickness" Value="0,0,1,1" />
                </Style>

                <!-- Cell alignment styles -->
                <Style x:Key="RightAlignedCell" TargetType="TextBlock">
                    <Setter Property="HorizontalAlignment" Value="Right" />
                    <Setter Property="TextAlignment" Value="Right" />
                    <Setter Property="Margin" Value="2,0,6,0" />
                </Style>
                <Style x:Key="CenteredCell" TargetType="TextBlock">
                    <Setter Property="HorizontalAlignment" Value="Center" />
                    <Setter Property="TextAlignment" Value="Center" />
                </Style>
                <Style x:Key="LeftAlignedCell" TargetType="TextBlock">
                    <Setter Property="HorizontalAlignment" Value="Left" />
                    <Setter Property="TextAlignment" Value="Left" />
                    <Setter Property="Margin" Value="2,0,2,0" />
                </Style>
            </Grid.Resources>

            <!-- inner highlight background (PanelLight) that fills under the rows -->
            <Border Margin="2" CornerRadius="4" Padding="0">
                <Border.Background>
                    <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                        <GradientStop Color="#BFE0FF" Offset="0.0" />
                        <GradientStop Color="#A7C9FF" Offset="0.6" />
                    </LinearGradientBrush>
                </Border.Background>


                <!-- make the DataGrid transparent so the inner PanelLight fills the rows uniformly -->
                <DataGrid x:Name="DataGridHost" AutoGenerateColumns="False" HeadersVisibility="Column" CanUserAddRows="False" CanUserDeleteRows="False" IsReadOnly="True" Background="Transparent" RowBackground="Transparent" AlternatingRowBackground="Transparent" GridLinesVisibility="None"
                          SelectionUnit="FullRow" SelectionMode="Single">
                    <DataGrid.Resources>
                        <!-- Prevent default system highlight visuals from showing -->
                        <SolidColorBrush x:Key="{x:Static SystemColors.HighlightBrushKey}" Color="Transparent" />
                        <SolidColorBrush x:Key="{x:Static SystemColors.ControlBrushKey}" Color="Transparent" />
                        <SolidColorBrush x:Key="{x:Static SystemColors.HighlightTextBrushKey}" Color="Black" />
                        <!-- Ensure any TextBlock inside the DataGrid uses black foreground so selection cannot change it -->
                        <Style TargetType="TextBlock">
                            <Setter Property="Foreground" Value="Black" />
                        </Style>
                    </DataGrid.Resources>
                    <!-- Keep row/cell text color consistent and prevent selection/hover background changes -->
                    <DataGrid.RowStyle>
                        <Style TargetType="DataGridRow">
                            <Setter Property="Foreground" Value="Black" />
                            <Setter Property="Background" Value="Transparent" />
                            <Setter Property="FocusVisualStyle" Value="{x:Null}" />
                            <Setter Property="Focusable" Value="False" />
                            <Style.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter Property="Foreground" Value="Black" />
                                    <Setter Property="Background" Value="Transparent" />
                                </Trigger>
                                <Trigger Property="IsSelected" Value="True">
                                    <Setter Property="Foreground" Value="Black" />
                                    <Setter Property="Background" Value="Transparent" />
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </DataGrid.RowStyle>

                    <DataGrid.CellStyle>
                        <Style TargetType="DataGridCell">
                            <Setter Property="Foreground" Value="Black" />
                            <Setter Property="Background" Value="Transparent" />
                            <Setter Property="FocusVisualStyle" Value="{x:Null}" />
                            <Setter Property="Focusable" Value="False" />
                            <Setter Property="BorderThickness" Value="0" />
                            <Style.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter Property="Foreground" Value="Black" />
                                    <Setter Property="Background" Value="Transparent" />
                                </Trigger>
                                <Trigger Property="IsSelected" Value="True">
                                    <Setter Property="Foreground" Value="Black" />
                                    <Setter Property="Background" Value="Transparent" />
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </DataGrid.CellStyle>
                <DataGrid.Columns>
                    <DataGridTextColumn Header="Phs" Binding="{Binding Phs}" Width="40">
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="TextBlock" BasedOn="{StaticResource CenteredCell}" />
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn Header="Form" Binding="{Binding Form}" Width="80">
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="TextBlock" BasedOn="{StaticResource LeftAlignedCell}" />
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn Header="Plancode" Binding="{Binding Plancode}" Width="120">
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="TextBlock" BasedOn="{StaticResource CenteredCell}" />
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn Header="IssueDate" Binding="{Binding IssueDate}" Width="90">
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="TextBlock" BasedOn="{StaticResource LeftAlignedCell}" />
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn Header="Amount" Binding="{Binding Amount}" Width="90">
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="TextBlock" BasedOn="{StaticResource RightAlignedCell}" />
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn Header="IssAge" Binding="{Binding IssAge}" Width="60">
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="TextBlock" BasedOn="{StaticResource RightAlignedCell}" />
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn Header="Gender" Binding="{Binding Gender}" Width="60">
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="TextBlock" BasedOn="{StaticResource CenteredCell}" />
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn Header="Class" Binding="{Binding Class}" Width="60">
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="TextBlock" BasedOn="{StaticResource CenteredCell}" />
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>
                </DataGrid.Columns>
                </DataGrid>
            </Border>
        </Grid>
    </Border>
</UserControl>